<!DOCTYPE html>
<html 
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
	layout:decorate="~{layout/layout.html}">
<head>
	<link href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<meta charset="UTF-8">
</head>
<body>
	<main layout:fragment="content">
		<!-- 강아지 커뮤니티 버튼 -->
		<div class="mt-3">
			<a class="btn mr-3 mb-3"
				th:each="item : ${communities}"
				th:classappend="${item.co_num} ? 'btn-info' : 'btn-outline-info'"
				th:text="${item.co_name}"
				th:href="@{/post/list/{co_num}(co_num=${item.co_num})}">강아지</a>
		</div>
			<h1>게시판 구현중</h1>
			<table id="dataTable" width="100%">
					<thead>
						<tr>
							<th>번호</th>
							<th>제목</th>
							<th>작성자</th>
							<th>작성일</th>
							<th>추천수</th>
							<th>조회수</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="item : ${list}">
							<td th:text="${item.po_num}"></td>
					        <td>
					            <a th:if="${item.po_delete == 1}">
					               <span class="text-muted">이 글은 삭제된 글입니다.</span>
					            </a>
					          
					            <a th:if="${item.po_delete == 0}"
					               th:text="${item.po_title}" 
					               th:href="@{/post/detail/{po_num}(po_num=${item.po_num})}">
					            </a>
					        </td>
							    <td th:text="${item.po_me_num}"></td>
						        <td th:text="${item.po_date}"></td>
						        <!-- 추천 수/비추천 수 출력 -->
						        <td>
						            <span th:text="${item.recommendCount}">추천수</span> / 
						            <span th:text="${item.notRecommendCount}">비추천수</span>
						        </td>
						        <td th:text="${item.po_viewCount}"></td>
						    </tr>

						<tr th:if="${list.size() == 0}">
							<td colspan="6" class="text-center">등록된 게시글이 없습니다.</td>
						</tr>
					</tbody>
			</table>
		<a class="btn btn btn-outline-dark" th:href="@{/post/insert/{co_num}(co_num=${co_num})}">글쓰기</a>
		<script type="text/javascript">
		cols = JSON.parse('[{"data":"po_num"}, {"data":"po_title"}, {"data":"po_me_num"}, {"data":"po_date"}, {"data":"recommendCount"}, {"data":"po_viewCount"}]');
		dt_result_table = $('#dataTable').DataTable({
			"serverSide" : true,
			"processing" : true,
			"destroy" : true,
			"ajax" : {
				"type" : "POST",
				"url" : '/petvely/api/endpoint'
			},
			"columns" : cols
		});
		</script>
	</main>
</body>
</html>